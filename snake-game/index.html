<html>
<head>

</head>

<body>

</body>

<script>

var cols = 100;
var rows = 30;
var SNAKE = 1;
var EMPTY = 0;
var FOOD = 2;
var grid = [];

var LEFT = 6;
var UP = 8;
var DOWN = 2;
var RIGHT = 4;
var queue = [];
var direction = LEFT;

var head = {x:3,y:6};
var food = {x:0,y:0};

var score = 0;

var reqId;
canvas = document.createElement("canvas")
	canvas.width = 10 * cols;
	canvas.height = 10 * rows;
	canvas.id = "myCanvas";

	document.body.appendChild(canvas);

scrdiv = document.createElement("div")
scrdiv.id = "score";

document.body.appendChild(scrdiv);

	var c = document.getElementById("myCanvas");


	var ctx = c.getContext("2d");



for(x = 0 ; x < cols ; x++)
{
	grid.push([]);
	for(y = 0; y < cols ; y++)
		grid[x].push(EMPTY);
}



function setSnake(){
	var flag = 0;
	for(var i = 0 ; i<queue.length; i++)
	{
		if(grid[queue[i].x][queue[i].y] == FOOD)
			flag = 1;
		grid[queue[i].x][queue[i].y] = SNAKE;
	}
	//if(flag)
		//setFood();
}

function checkCollision()
{
	var flag = 0;
	for(var i = 0; i<queue.length-1; i++)
	{
		if(queue[i].x == head.x && queue[i].y == head.y)
		{
			queue = [];
			ctx.clearRect(0,0,10*cols,10*rows);
			ctx.strokeRect(0,0,10*cols,10*rows);
			flag = 1;
			break;
			

			
		}
	}
	if(flag)
		init();
}
function fillColors(){
	for(var i=0; i<cols;i++)
	{
		for(var j=0; j<rows;j++)
		{
			//ctx.strokeRect(i*10,j*10,10,10);
			if(grid[i][j] == SNAKE)
			{
				ctx.fillStyle = "#000";
				ctx.fillRect(i*10,j*10,10,10);
			}
			if(grid[i][j] == FOOD)
			{
				ctx.fillStyle = "#0ff";
				ctx.fillRect(i*10,j*10,10,10);
			}
		
		}
	}
}
function setFood(ctx) {
	food.x = Math.floor(Math.random()*(cols-2))+1;
	food.y = Math.floor(Math.random()*(rows-2))+1;

	grid[food.x][food.y] = FOOD;
}
function init()
{
	main();
	move();
}

window.addEventListener("keydown", onKeyDown, false);


function onKeyDown(event)
{
	
	var keyCode = event.keyCode;
	switch(keyCode)
	{
		case 37:
			if(direction!=LEFT)
			direction = RIGHT;
			break;
		case 38:
			if(direction!=DOWN)
			direction = UP;
			break;
		case 39:
			if(direction!=RIGHT)
			direction = LEFT;
			break;
		case 40:
			if(direction!=UP)
			direction = DOWN;
			break;
		case 32:
			if(freq == 2)
			freq = 5;
			else
				freq = 2;
			break;


	}
}

function main()
{
	
	ctx.clearRect(0,0,10*cols,10*rows);
	ctx.strokeRect(0,0,10*cols,10*rows);
	
	queue.push(head);

	document.getElementById('score').innerHTML = score;
	
	setSnake();
	setFood();
	fillColors(ctx);

}
var frames = 0;
var freq = 8;
function move()
{
	
	
	frames++;
	if(frames%freq == 0)
	{
	switch(direction)
	{
		case LEFT:
			if(head.x<cols-1)
			{
			var tobepushed = {x:head.x+1, y:head.y};
			if(tobepushed.x == food.x && tobepushed.y == food.y)
			{
				console.log("yes");
				score++;
				setFood();
				document.getElementById('score').innerHTML = score;
			}
			else
			{
				var removed = queue.shift();
				grid[removed.x][removed.y] = EMPTY;
			}
			queue.push(tobepushed);
			setSnake();
			head = tobepushed;
			ctx.clearRect(0,0,10*cols,10*rows);
			ctx.strokeRect(0,0,10*cols,10*rows);
			fillColors();
			}
			else
			{	
				var tobepushed = {x:0,y:head.y};
				queue.push(tobepushed);
				var removed = queue.shift();
				grid[removed.x][removed.y] = EMPTY;
				setSnake();
				head = tobepushed;
			}
			break;
		case RIGHT:
			if(head.x>0)
			{
			var tobepushed = {x:head.x-1, y:head.y};
			if(tobepushed.x == food.x && tobepushed.y == food.y)
			{
				console.log("yes");
				score++;
				setFood();
				document.getElementById('score').innerHTML = score;
			}
			else
			{
				var removed = queue.shift();
				grid[removed.x][removed.y] = EMPTY;

			}
			queue.push(tobepushed);
			setSnake();
			head = tobepushed;
			ctx.clearRect(0,0,10*cols,10*rows);
			ctx.strokeRect(0,0,10*cols,10*rows);
			fillColors();
			}
			else
			{	
				var tobepushed = {x:cols-1,y:head.y};
				queue.push(tobepushed);
				var removed = queue.shift();
				grid[removed.x][removed.y] = EMPTY;
				setSnake();
				head = tobepushed;
			}
			break;
		case UP:
			if(head.y>0)
			{
			var tobepushed = {x:head.x, y:head.y-1};
			if(tobepushed.x == food.x && tobepushed.y == food.y)
			{

				console.log("yes");
				score++;
				setFood();
				document.getElementById('score').innerHTML = score;
			}
			else
			{
				var removed = queue.shift();
				grid[removed.x][removed.y] = EMPTY;
			}
			queue.push(tobepushed);
			setSnake();
			head = tobepushed;
			ctx.clearRect(0,0,10*cols,10*rows);
			ctx.strokeRect(0,0,10*cols,10*rows);
			fillColors();
			}
			else
			{	
				var tobepushed = {x:head.x,y:rows - 1};
				queue.push(tobepushed);
				var removed = queue.shift();
				grid[removed.x][removed.y] = EMPTY;
				setSnake();
				head = tobepushed;
			}
			break;
		case DOWN:
			if(head.y<rows-1)
			{
			var tobepushed = {x:head.x, y:head.y+1};
			if(tobepushed.x == food.x && tobepushed.y == food.y)
			{
				console.log("yes");
				score++;
				setFood();
				document.getElementById('score').innerHTML = score;
			}
			else
			{
				var removed = queue.shift();
				grid[removed.x][removed.y] = EMPTY;
			}
			
			
			queue.push(tobepushed);
			setSnake();
			head = tobepushed;
			ctx.clearRect(0,0,10*cols,10*rows);
			ctx.strokeRect(0,0,10*cols,10*rows);
			fillColors();
			}
			else
			{	
				var tobepushed = {x:head.x,y:0};
				queue.push(tobepushed);
				var removed = queue.shift();
				grid[removed.x][removed.y] = EMPTY;
				setSnake();
				head = tobepushed;
			}
			break;
	}
	//checkCollision();
}
	
	reqId = window.requestAnimationFrame(move);

}


init();




</script>

</html>